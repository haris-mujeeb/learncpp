{"id":173,"date":"2008-01-14T13:09:02","date_gmt":"2008-01-14T21:09:02","guid":{"rendered":"http:\/\/www.learncpp.com\/cpp-tutorial\/115-inheritance-and-access-specifiers\/"},"modified":"2023-09-11T11:08:42","modified_gmt":"2023-09-11T18:08:42","slug":"inheritance-and-access-specifiers","status":"publish","type":"post","link":"https:\/\/www.learncpp.com\/cpp-tutorial\/inheritance-and-access-specifiers\/","title":{"rendered":"24.5 &#8212; Inheritance and access specifiers"},"content":{"rendered":"<p>In the previous lessons in this chapter, you&#8217;ve learned a bit about how base inheritance works.  In all of our examples so far, we&#8217;ve used public inheritance.  That is, our derived class publicly inherits the base class.<\/p>\n<p>In this lesson, we&#8217;ll take a closer look at public inheritance, as well as the two other kinds of inheritance (private and protected).  We&#8217;ll also explore how the different kinds of inheritance interact with access specifiers to allow or restrict access to members.<\/p>\n<p>To this point, you&#8217;ve seen the private and public access specifiers, which determine who can access the members of a class.  As a quick refresher, public members can be accessed by anybody.  Private members can only be accessed by member functions of the same class or friends.  This means derived classes can not access private members of the base class directly!<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class Base\r\n{\r\nprivate:\r\n    int m_private {}; \/\/ can only be accessed by Base members and friends (not derived classes)\r\npublic:\r\n    int m_public {}; \/\/ can be accessed by anybody\r\n};<\/code><\/pre>\n<p>This is pretty straightforward, and you should be quite used to it by now.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">The protected access specifier<\/p>\n<p>When dealing with inherited classes, things get a bit more complex.<\/p>\n<p>C++ has a third access specifier that we have yet to talk about because it&#8217;s only useful in an inheritance context.  The <strong>protected<\/strong> access specifier allows the class the member belongs to, friends,  and derived classes to access the member.  However, protected members are not accessible from outside the class.<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class Base\r\n{\r\npublic:\r\n    int m_public {}; \/\/ can be accessed by anybody\r\nprotected:\r\n    int m_protected {}; \/\/ can be accessed by Base members, friends, and derived classes\r\nprivate:\r\n    int m_private {}; \/\/ can only be accessed by Base members and friends (but not derived classes)\r\n};\r\n\r\nclass Derived: public Base\r\n{\r\npublic:\r\n    Derived()\r\n    {\r\n        m_public = 1; \/\/ allowed: can access public base members from derived class\r\n        m_protected = 2; \/\/ allowed: can access protected base members from derived class\r\n        m_private = 3; \/\/ not allowed: can not access private base members from derived class\r\n    }\r\n};\r\n\r\nint main()\r\n{\r\n    Base base;\r\n    base.m_public = 1; \/\/ allowed: can access public members from outside class\r\n    base.m_protected = 2; \/\/ not allowed: can not access protected members from outside class\r\n    base.m_private = 3; \/\/ not allowed: can not access private members from outside class\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>In the above example, you can see that the protected base member m_protected is directly accessible by the derived class, but not by the public.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">So when should I use the protected access specifier?<\/p>\n<p>With a protected attribute in a base class, derived classes can access that member directly.  This means that if you later change anything about that protected attribute (the type, what the value means, etc&#8230;), you&#8217;ll probably need to change both the base class AND all of the derived classes.<\/p>\n<p>Therefore, using the protected access specifier is most useful when you (or your team) are going to be the ones deriving from your own classes, and the number of derived classes is reasonable.  That way, if you make a change to the implementation of the base class, and updates to the derived classes are necessary as a result, you can make the updates yourself (and have it not take forever, since the number of derived classes is limited).<\/p>\n<p>Making your members private means the public and derived classes can&#8217;t directly make changes to the base class.  This is good for insulating the public or derived classes from implementation changes, and for ensuring invariants are maintained properly.  However, it also means your class may need a larger public (or protected) interface to support all of the functions that the public or derived classes need for operation, which has its own cost to build, test, and maintain.<\/p>\n<p>In general, it&#8217;s better to make your members private if you can, and only use protected when derived classes are planned and the cost to build and maintain an interface to those private members is too high.<\/p>\n<div class=\"cpp-note cpp-lightgreenbackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Best practice<\/p>\n<p>Favor private members over protected members.\n<\/p><\/div>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Different kinds of inheritance, and their impact on access<\/p>\n<p>First, there are three different ways for classes to inherit from other classes: public, protected, and private.  <\/p>\n<p>To do so, simply specify which type of access you want when choosing the class to inherit from:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">\/\/ Inherit from Base publicly\r\nclass Pub: public Base\r\n{\r\n};\r\n\r\n\/\/ Inherit from Base protectedly\r\nclass Pro: protected Base\r\n{\r\n};\r\n\r\n\/\/ Inherit from Base privately\r\nclass Pri: private Base\r\n{\r\n};\r\n\r\nclass Def: Base \/\/ Defaults to private inheritance\r\n{\r\n};<\/code><\/pre>\n<p>If you do not choose an inheritance type, C++ defaults to private inheritance (just like members default to private access if you do not specify otherwise).<\/p>\n<p>That gives us 9 combinations: 3 member access specifiers (public, private, and protected), and 3 inheritance types (public, private, and protected).<\/p>\n<p>So what&#8217;s the difference between these?  In a nutshell, when members are inherited, the access specifier for an inherited member may be changed (in the derived class only) depending on the type of inheritance used.  Put another way, members that were public or protected in the base class may change access specifiers in the derived class.<\/p>\n<p>This might seem a little confusing, but it&#8217;s not that bad.  We&#8217;ll spend the rest of this lesson exploring this in detail.<\/p>\n<p>Keep in mind the following rules as we step through the examples:<\/p>\n<ul>\n<li>A class can always access its own (non-inherited) members.<\/li>\n<li>The public accesses the members of a class based on the access specifiers of the class it is accessing.<\/li>\n<li>A derived class accesses inherited members based on the access specifier inherited from the parent class.  This varies depending on the access specifier and type of inheritance used.<\/li>\n<\/ul>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Public inheritance<\/p>\n<p>Public inheritance is by far the most commonly used type of inheritance.  In fact, very rarely will you see or use the other types of inheritance, so your primary focus should be on understanding this section.  Fortunately, public inheritance is also the easiest to understand.  When you inherit a base class publicly, inherited public members stay public, and inherited protected members stay protected.  Inherited private members, which were inaccessible because they were private in the base class, stay inaccessible.<\/p>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<th>Access specifier in base class<\/th>\n<th>Access specifier when inherited publicly<\/th>\n<\/tr>\n<tr>\n<td>Public<\/td>\n<td>Public<\/td>\n<\/tr>\n<tr>\n<td>Protected<\/td>\n<td>Protected<\/td>\n<\/tr>\n<tr>\n<td>Private<\/td>\n<td>Inaccessible<\/td>\n<\/tr>\n<p><\/table><\/div>\n<p>Here&#8217;s an example showing how things work:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class Base\r\n{\r\npublic:\r\n    int m_public {};\r\nprotected:\r\n    int m_protected {};\r\nprivate:\r\n    int m_private {};\r\n};\r\n\r\nclass Pub: public Base \/\/ note: public inheritance\r\n{\r\n    \/\/ Public inheritance means:\r\n    \/\/ Public inherited members stay public (so m_public is treated as public)\r\n    \/\/ Protected inherited members stay protected (so m_protected is treated as protected)\r\n    \/\/ Private inherited members stay inaccessible (so m_private is inaccessible)\r\npublic:\r\n    Pub()\r\n    {\r\n        m_public = 1; \/\/ okay: m_public was inherited as public\r\n        m_protected = 2; \/\/ okay: m_protected was inherited as protected\r\n        m_private = 3; \/\/ not okay: m_private is inaccessible from derived class\r\n    }\r\n};\r\n\r\nint main()\r\n{\r\n    \/\/ Outside access uses the access specifiers of the class being accessed.\r\n    Base base;\r\n    base.m_public = 1; \/\/ okay: m_public is public in Base\r\n    base.m_protected = 2; \/\/ not okay: m_protected is protected in Base\r\n    base.m_private = 3; \/\/ not okay: m_private is private in Base\r\n\r\n    Pub pub;\r\n    pub.m_public = 1; \/\/ okay: m_public is public in Pub\r\n    pub.m_protected = 2; \/\/ not okay: m_protected is protected in Pub\r\n    pub.m_private = 3; \/\/ not okay: m_private is inaccessible in Pub\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>This is the same as the example above where we introduced the protected access specifier, except that we&#8217;ve instantiated the derived class as well, just to show that with public inheritance, things work identically in the base and derived class.<\/p>\n<p>Public inheritance is what you should be using unless you have a specific reason not to.<\/p>\n<div class=\"cpp-note cpp-lightgreenbackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Best practice<\/p>\n<p>Use public inheritance unless you have a specific reason to do otherwise.\n<\/p><\/div>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Protected inheritance<\/p>\n<p>Protected inheritance is the least common method of inheritance.  It is almost never used, except in very particular cases.  With protected inheritance, the public and protected members become protected, and private members stay inaccessible.<\/p>\n<p>Because this form of inheritance is so rare, we&#8217;ll skip the example and just summarize with a table:<\/p>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<th>Access specifier in base class<\/th>\n<th>Access specifier when inherited protectedly<\/th>\n<\/tr>\n<tr>\n<td>Public<\/td>\n<td>Protected<\/td>\n<\/tr>\n<tr>\n<td>Protected<\/td>\n<td>Protected<\/td>\n<\/tr>\n<tr>\n<td>Private<\/td>\n<td>Inaccessible<\/td>\n<\/tr>\n<p><\/table><\/div>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Private inheritance<\/p>\n<p>With private inheritance, all members from the base class are inherited as private.  This means private members are inaccessible, and protected and public members become private.<\/p>\n<p>Note that this does not affect the way that the derived class accesses members inherited from its parent!  It only affects the code trying to access those members through the derived class.<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class Base\r\n{\r\npublic:\r\n    int m_public {};\r\nprotected:\r\n    int m_protected {};\r\nprivate:\r\n    int m_private {};\r\n};\r\n\r\nclass Pri: private Base \/\/ note: private inheritance\r\n{\r\n    \/\/ Private inheritance means:\r\n    \/\/ Public inherited members become private (so m_public is treated as private)\r\n    \/\/ Protected inherited members become private (so m_protected is treated as private)\r\n    \/\/ Private inherited members stay inaccessible (so m_private is inaccessible)\r\npublic:\r\n    Pri()\r\n    {\r\n        m_public = 1; \/\/ okay: m_public is now private in Pri\r\n        m_protected = 2; \/\/ okay: m_protected is now private in Pri\r\n        m_private = 3; \/\/ not okay: derived classes can't access private members in the base class\r\n    }\r\n};\r\n\r\nint main()\r\n{\r\n    \/\/ Outside access uses the access specifiers of the class being accessed.\r\n    \/\/ In this case, the access specifiers of base.\r\n    Base base;\r\n    base.m_public = 1; \/\/ okay: m_public is public in Base\r\n    base.m_protected = 2; \/\/ not okay: m_protected is protected in Base\r\n    base.m_private = 3; \/\/ not okay: m_private is private in Base\r\n\r\n    Pri pri;\r\n    pri.m_public = 1; \/\/ not okay: m_public is now private in Pri\r\n    pri.m_protected = 2; \/\/ not okay: m_protected is now private in Pri\r\n    pri.m_private = 3; \/\/ not okay: m_private is inaccessible in Pri\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>To summarize in table form:<\/p>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<th>Access specifier in base class<\/th>\n<th>Access specifier when inherited privately<\/th>\n<\/tr>\n<tr>\n<td>Public<\/td>\n<td>Private<\/td>\n<\/tr>\n<tr>\n<td>Protected<\/td>\n<td>Private<\/td>\n<\/tr>\n<tr>\n<td>Private<\/td>\n<td>Inaccessible<\/td>\n<\/tr>\n<p><\/table><\/div>\n<p>Private inheritance can be useful when the derived class has no obvious relationship to the base class, but uses the base class for implementation internally.  In such a case, we probably don&#8217;t want the public interface of the base class to be exposed through objects of the derived class (as it would be if we inherited publicly).<\/p>\n<p>In practice, private inheritance is rarely used.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">A final example<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class Base\r\n{\r\npublic:\r\n\tint m_public {};\r\nprotected:\r\n\tint m_protected {};\r\nprivate:\r\n\tint m_private {};\r\n};<\/code><\/pre>\n<p>Base can access its own members without restriction.  The public can only access m_public.  Derived classes can access m_public and m_protected.<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class D2 : private Base \/\/ note: private inheritance\r\n{\r\n\t\/\/ Private inheritance means:\r\n\t\/\/ Public inherited members become private\r\n\t\/\/ Protected inherited members become private\r\n\t\/\/ Private inherited members stay inaccessible\r\npublic:\r\n\tint m_public2 {};\r\nprotected:\r\n\tint m_protected2 {};\r\nprivate:\r\n\tint m_private2 {};\r\n};<\/code><\/pre>\n<p>D2 can access its own members without restriction.  D2 can access Base&#8217;s m_public and m_protected members, but not m_private.  Because D2 inherited Base privately, m_public and m_protected are now considered private when accessed through D2.  This means the public can not access these variables when using a D2 object, nor can any classes derived from D2.<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">class D3 : public D2\r\n{\r\n\t\/\/ Public inheritance means:\r\n\t\/\/ Public inherited members stay public\r\n\t\/\/ Protected inherited members stay protected\r\n\t\/\/ Private inherited members stay inaccessible\r\npublic:\r\n\tint m_public3 {};\r\nprotected:\r\n\tint m_protected3 {};\r\nprivate:\r\n\tint m_private3 {};\r\n};<\/code><\/pre>\n<p>D3 can access its own members without restriction. D3 can access D2&#8217;s m_public2 and m_protected2 members, but not m_private2.  Because D3 inherited D2 publicly, m_public2 and m_protected2 keep their access specifiers when accessed through D3.  D3 has no access to Base&#8217;s m_private, which was already private in Base.  Nor does it have access to Base&#8217;s m_protected or m_public, both of which became private when D2 inherited them.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Summary<\/p>\n<p>The way that the access specifiers, inheritance types, and derived classes interact causes a lot of confusion.  To try and clarify things as much as possible:<\/p>\n<p>First, a class (and friends) can always access its own non-inherited members.  The access specifiers only affect whether outsiders and derived classes can access those members.<\/p>\n<p>Second, when derived classes inherit members, those members may change access specifiers in the derived class.  This does not affect the derived classes&#8217; own (non-inherited) members (which have their own access specifiers).  It only affects whether outsiders and classes derived from the derived class can access those inherited members.<\/p>\n<p>Here&#8217;s a table of all of the access specifier and inheritance types combinations:<\/p>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<th>Access specifier in base class<\/th>\n<th>Access specifier when inherited publicly<\/th>\n<th>Access specifier when inherited privately<\/th>\n<th>Access specifier when inherited protectedly<\/th>\n<\/tr>\n<tr>\n<td>Public<\/td>\n<td>Public<\/td>\n<td>Private<\/td>\n<td>Protected<\/td>\n<\/tr>\n<tr>\n<td>Protected<\/td>\n<td>Protected<\/td>\n<td>Private<\/td>\n<td>Protected<\/td>\n<\/tr>\n<tr>\n<td>Private<\/td>\n<td>Inaccessible<\/td>\n<td>Inaccessible<\/td>\n<td>Inaccessible<\/td>\n<\/tr>\n<p><\/table><\/div>\n<p>As a final note, although in the examples above, we&#8217;ve only shown examples using member variables, these access rules hold true for all members (e.g. member functions and types declared inside the class).<\/p>\n<div class=\"prevnext\"><div class=\"prevnext-inline\">\n\t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/adding-new-functionality-to-a-derived-class\/\">\n <div class=\"nav-button nav-button-next\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-right\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Next lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">24.6<\/span>Adding new functionality to a derived class\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  \t<a class=\"nav-link\" href=\"\/\">\n  <div class=\"nav-button nav-button-index\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-home\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Back to table of contents<\/div>\n    <\/div>\n<\/div><\/a>\n  \t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/constructors-and-initialization-of-derived-classes\/\">\n  <div class=\"nav-button nav-button-prev\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-left\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Previous lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">24.4<\/span>Constructors and initialization of derived classes\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  <\/div><\/div>\n","protected":false},"excerpt":{"rendered":"<p>In the previous lessons in this chapter, you&#8217;ve learned a bit about how base inheritance works. In all of our examples so far, we&#8217;ve used public inheritance. That is, our derived class publicly inherits the base class. In this lesson, we&#8217;ll take a closer look at public inheritance, as well &hellip;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[3],"tags":[],"_links":{"self":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/173"}],"collection":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/comments?post=173"}],"version-history":[{"count":29,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/173\/revisions"}],"predecessor-version":[{"id":15271,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/173\/revisions\/15271"}],"wp:attachment":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/media?parent=173"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/categories?post=173"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/tags?post=173"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}