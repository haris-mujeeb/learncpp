{"id":12415,"date":"2022-01-18T10:24:47","date_gmt":"2022-01-18T18:24:47","guid":{"rendered":"https:\/\/www.learncpp.com\/?p=12415"},"modified":"2024-11-29T14:37:53","modified_gmt":"2024-11-29T22:37:53","slug":"passing-and-returning-structs","status":"publish","type":"post","link":"https:\/\/www.learncpp.com\/cpp-tutorial\/passing-and-returning-structs\/","title":{"rendered":"13.10 &#8212; Passing and returning structs"},"content":{"rendered":"<p>Consider an employee represented by 3 loose variables:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">int main()\r\n{\r\n    int id { 1 };\r\n    int age { 24 };\r\n    double wage { 52400.0 };\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>If we want to pass this employee to a function, we have to pass three variables:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nvoid printEmployee(int id, int age, double wage)\r\n{\r\n    std::cout &lt;&lt; \"ID:   \" &lt;&lt; id &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Age:  \" &lt;&lt; age &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Wage: \" &lt;&lt; wage &lt;&lt; '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n    int id { 1 };\r\n    int age { 24 };\r\n    double wage { 52400.0 };\r\n\r\n    printEmployee(id, age, wage);\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>While passing 3 individual employee variables isn&#8217;t that bad, consider a function where we need to pass 10 or 12 employee variables.  Passing each variable independently would be time consuming and error prone.  Additionally, if we ever add a new attribute to our employee (e.g. name), we now have to modify all the functions declarations, definitions, and function calls to accept the new parameter and argument!<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Passing structs (by reference)<\/p>\n<p>A big advantage of using structs over individual variables is that we can pass the entire struct to a function that needs to work with the members.  Structs are generally passed by reference (typically by const reference) to avoid making copies.<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nstruct Employee\r\n{\r\n    int id {};\r\n    int age {};\r\n    double wage {};\r\n};\r\n\r\nvoid printEmployee(const Employee&amp; employee) \/\/ note pass by reference here\r\n{\r\n    std::cout &lt;&lt; \"ID:   \" &lt;&lt; employee.id &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Age:  \" &lt;&lt; employee.age &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Wage: \" &lt;&lt; employee.wage &lt;&lt; '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n    Employee joe { 14, 32, 24.15 };\r\n    Employee frank { 15, 28, 18.27 };\r\n\r\n    \/\/ Print Joe's information\r\n    printEmployee(joe);\r\n\r\n    std::cout &lt;&lt; '\\n';\r\n\r\n    \/\/ Print Frank's information\r\n    printEmployee(frank);\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>In the above example, we pass an entire <code>Employee<\/code> to <code>printEmployee()<\/code> (twice, once for <code>joe<\/code> and once for <code>frank<\/code>).<\/p>\n<p>The above program outputs:<\/p>\n<pre>\nID:   14\r\nAge:  32\r\nWage: 24.15\r\n\r\nID:   15\r\nAge:  28\r\nWage: 18.27\r\n<\/pre>\n<p>Because we are passing the entire struct object (rather than individual members), we only need one parameter no matter how many members the struct object has.  And, in the future, if we ever decide to add new members to our <code>Employee<\/code> struct, we will not have to change the function declaration or function call!  The new member will automatically be included.<\/p>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Related content<\/p>\n<p>We talk about when to pass structs by value vs reference in lesson <a href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/pass-by-const-lvalue-reference\/\">12.6 -- Pass by const lvalue reference<\/a>.\n<\/p><\/div>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Passing temporary structs<\/p>\n<p>In the prior example, we created Employee variable <code>joe<\/code> prior to passing it to the <code>printEmployee()<\/code> function.  This allows us to give the Employee variable a name, which can be useful for documentation purposes.  But it also requires two statements (one to create <code>joe<\/code>, one to use <code>joe<\/code>).<\/p>\n<p>In cases where we only use a variable once, having to give the variable a name and separate the creation and use of that variable can increase complexity.  In such cases, it may be preferable to use a temporary object instead.  A temporary object is not a variable, so it does not have an identifier.<\/p>\n<p>Here&#8217;s the same example as above, but we&#8217;ve replaced variables <code>joe<\/code> and <code>frank<\/code> with temporary objects:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nstruct Employee\r\n{\r\n    int id {};\r\n    int age {};\r\n    double wage {};\r\n};\r\n\r\nvoid printEmployee(const Employee&amp; employee) \/\/ note pass by reference here\r\n{\r\n    std::cout &lt;&lt; \"ID:   \" &lt;&lt; employee.id &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Age:  \" &lt;&lt; employee.age &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Wage: \" &lt;&lt; employee.wage &lt;&lt; '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n    \/\/ Print Joe's information\r\n    printEmployee(Employee { 14, 32, 24.15 }); \/\/ construct a temporary Employee to pass to function (type explicitly specified) (preferred)\r\n\r\n    std::cout &lt;&lt; '\\n';\r\n\r\n    \/\/ Print Frank's information\r\n    printEmployee({ 15, 28, 18.27 }); \/\/ construct a temporary Employee to pass to function (type deduced from parameter)\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>We can create a temporary <code>Employee<\/code> in two ways.  In the first call, we use the syntax <code>Employee { 14, 32, 24.15 }<\/code>.  This tells the compiler to create an <code>Employee<\/code> object and initialize it with the provided initializers.  This is the preferred syntax because it makes clear what kind of temporary object we are creating, and there is no way for the compiler to misinterpret our intentions.<\/p>\n<p>In the second call, we use the syntax <code>{ 15, 28, 18.27 }<\/code>.  The compiler is smart enough to understand that the provided arguments must be converted to an <code>Employee<\/code> so that the function call will succeed.  Note that this form is considered an implicit conversion, so it will not work in cases where only explicit conversions are acceptable.<\/p>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Related content<\/p>\n<p>We talk more about class type temporary objects and conversions in lesson <a href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/temporary-class-objects\/\">14.13 -- Temporary class objects<\/a>.\n<\/p><\/div>\n<p>A few more things about temporary objects: they are created and initialized at the point of definition, and are destroyed at the end of the full expression in which they are created.  And evaluation of a temporary object is an rvalue expression, it can only be used in places where rvalues are accepted.  When a temporary object is used as a function argument, it will only bind to parameters that accept rvalues.  This includes pass by value and pass by const reference, and excludes pass by non-const reference and pass by address.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Returning structs<\/p>\n<p>Consider the case where we have a function that needs to return a point in 3-dimensional Cartesian space. Such a point has 3 attributes: an x-coordinate, a y-coordinate, and a z-coordinate.  But functions can only return one value.  So how do we return all 3 coordinates back the user?<\/p>\n<p>One common way is to return a struct:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nstruct Point3d\r\n{\r\n    double x { 0.0 };\r\n    double y { 0.0 };\r\n    double z { 0.0 };\r\n};\r\n\r\nPoint3d getZeroPoint()\r\n{\r\n    \/\/ We can create a variable and return the variable (we'll improve this below)\r\n    Point3d temp { 0.0, 0.0, 0.0 };\r\n    return temp;\r\n}\r\n\r\nint main()\r\n{\r\n    Point3d zero{ getZeroPoint() };\r\n\r\n    if (zero.x == 0.0 &amp;&amp; zero.y == 0.0 &amp;&amp; zero.z == 0.0)\r\n        std::cout &lt;&lt; \"The point is zero\\n\";\r\n    else\r\n        std::cout &lt;&lt; \"The point is not zero\\n\";\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>This prints:<\/p>\n<pre>\nThe point is zero\r\n<\/pre>\n<p>Structs defined inside functions are usually returned by value, so as not to return a dangling reference.<\/p>\n<p>In the <code>getZeroPoint()<\/code> function above, we create a new named object (<code>temp<\/code>) just so we could return it:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">Point3d getZeroPoint()\r\n{\r\n    \/\/ We can create a variable and return the variable (we'll improve this below)\r\n    Point3d temp { 0.0, 0.0, 0.0 };\r\n    return temp;\r\n}<\/code><\/pre>\n<p>The name of the object (<code>temp<\/code>) doesn&#8217;t really provide any documentation value here.<\/p>\n<p>We can make our function slightly better by returning a temporary (unnamed\/anonymous) object instead:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">Point3d getZeroPoint()\r\n{\r\n    return Point3d { 0.0, 0.0, 0.0 }; \/\/ return an unnamed Point3d\r\n}<\/code><\/pre>\n<p>In this case, a temporary <code>Point3d<\/code> is constructed, copied back to the caller, and then destroyed at the end of the expression.  Note how much cleaner this is (one line vs two, and no need to understand whether <code>temp<\/code> is used more than once).<\/p>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Related content<\/p>\n<p>We discuss anonymous objects in more detail in lesson <a href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/temporary-class-objects\/\">14.13 -- Temporary class objects<\/a>.\n<\/p><\/div>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Deducing the return type<\/p>\n<p>In the case where the function has an explicit return type (e.g. <code>Point3d<\/code>), we can even omit the type in the return statement:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">Point3d getZeroPoint()\r\n{\r\n    \/\/ We already specified the type at the function declaration\r\n    \/\/ so we don't need to do so here again\r\n    return { 0.0, 0.0, 0.0 }; \/\/ return an unnamed Point3d\r\n}<\/code><\/pre>\n<p>This is considered to be an implicit conversion.<\/p>\n<p>Also note that since in this case we&#8217;re returning all zero values, we can use empty braces to return a value-initialized Point3d:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">Point3d getZeroPoint()\r\n{\r\n    \/\/ We can use empty curly braces to value-initialize all members\r\n    return {};\r\n}<\/code><\/pre>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Structs are an important building block<\/p>\n<p>While structs are useful in and of themselves, classes (which are the heart of C++ and object oriented programming) build directly on top of the concepts we&#8217;ve introduced here.  Having a good understanding of structs (especially data members, member selection, and default member initialization) will make your transition to classes that much easier.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Quiz time<\/p>\n<p class=\"cpp-quiz-question\" style=\"clear: both\">Question #1<\/p>\n<p>You are running a website, and you are trying to calculate your advertising revenue.  Write a program that allows you to enter 3 pieces of data:<\/p>\n<ul>\n<li>How many ads were watched.\n<\/li>\n<li>What percentage of users clicked on an ad.\n<\/li>\n<li>The average earnings per clicked ad.\n<\/li>\n<\/ul>\n<p>Store those 3 values in a struct.  Pass that struct to another function that prints each of the values.  The print function should also print how much you made for that day (multiply the 3 fields together).<\/p>\n<p><a class=\"hint_link_show\" href=\"javascript:void(0)\" onclick=\"cppHintToggle(document.getElementById('cpp_hint_id_0'), this, 'Show Hint', '')\">Show Hint<\/a><\/p>\n<div class=\"wphint\" id=\"cpp_hint_id_0\" style=\"display:none; margin-bottom: 1em\">Hint: If you store the percentage as an integer, you&#8217;ll also need to divide by 100 when you calculate how much you made for the day.<\/div>\n<p><a class=\"solution_link_show\" href=\"javascript:void(0)\" onclick=\"cppSolutionToggle(document.getElementById('cpp_solution_id_0'), this, 'Show Solution', 'Hide Solution')\">Show Solution<\/a><\/p>\n<div class=\"wpsolution\" id=\"cpp_solution_id_0\" style=\"display:none\">\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\n\/\/ First we need to define our Advertising struct\r\nstruct Advertising\r\n{\r\n    int adsShown {};\r\n    double clickThroughRatePercentage {};\r\n    double averageEarningsPerClick {};\r\n};\r\n\r\nAdvertising getAdvertising()\r\n{\r\n    Advertising temp {};\r\n    std::cout &lt;&lt; \"How many ads were shown today? \";\r\n    std::cin &gt;&gt; temp.adsShown;\r\n    std::cout &lt;&lt; \"What percentage of ads were clicked on by users? \";\r\n    std::cin &gt;&gt; temp.clickThroughRatePercentage;\r\n    std::cout &lt;&lt; \"What was the average earnings per click? \";\r\n    std::cin &gt;&gt; temp.averageEarningsPerClick;\r\n\r\n    return temp;\r\n}\r\n\r\nvoid printAdvertising(const Advertising&amp; ad)\r\n{\r\n    std::cout &lt;&lt; \"Number of ads shown: \" &lt;&lt; ad.adsShown &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Click through rate: \" &lt;&lt; ad.clickThroughRatePercentage &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; \"Average earnings per click: $\" &lt;&lt; ad.averageEarningsPerClick &lt;&lt; '\\n';\r\n\r\n    \/\/ The following line is split up to reduce the length\r\n    \/\/ We need to divide ad.clickThroughRatePercentage by 100 because it's a percent of 100, not a multiplier\r\n    std::cout &lt;&lt; \"Total Earnings: $\"\r\n        &lt;&lt; (ad.adsShown * ad.clickThroughRatePercentage \/ 100 * ad.averageEarningsPerClick) &lt;&lt; '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n    \/\/ Declare an Advertising struct variable\r\n    Advertising ad{ getAdvertising() };\r\n    printAdvertising(ad);\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<\/div>\n<p class=\"cpp-quiz-question cpp-topline\" style=\"clear: both\">Question #2<\/p>\n<p>Create a struct to hold a fraction.  The struct should have an integer numerator and an integer denominator member.  <\/p>\n<p>Write a function to read in a Fraction from the user, and use it to read-in two fraction objects.  Write another function to multiply two Fractions together and return the result as a Fraction (you don&#8217;t need to reduce the fraction).  Write another function that prints a fraction.<\/p>\n<p>Your program&#8217;s output should match the following:<\/p>\n<pre>\nEnter a value for the numerator: 1\r\nEnter a value for the denominator: 2\r\n\r\nEnter a value for the numerator: 3\r\nEnter a value for the denominator: 4\r\n\r\nYour fractions multiplied together: 3\/8\r\n<\/pre>\n<p>When multiplying two fractions together, the resulting numerator is the product of the two numerators, and the resulting denominator is the product of the two denominators.<\/p>\n<p><a class=\"solution_link_show\" href=\"javascript:void(0)\" onclick=\"cppSolutionToggle(document.getElementById('cpp_solution_id_1'), this, 'Show Solution', 'Hide Solution')\">Show Solution<\/a><\/p>\n<div class=\"wpsolution\" id=\"cpp_solution_id_1\" style=\"display:none\">\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nstruct Fraction\r\n{\r\n    int numerator{ 0 };\r\n    int denominator{ 1 };\r\n};\r\n\r\nFraction getFraction()\r\n{\r\n    Fraction temp{};\r\n    std::cout &lt;&lt; \"Enter a value for numerator: \";\r\n    std::cin &gt;&gt; temp.numerator;\r\n    std::cout &lt;&lt; \"Enter a value for denominator: \";\r\n    std::cin &gt;&gt; temp.denominator;\r\n    std::cout &lt;&lt; '\\n';\r\n\r\n    return temp;\r\n}\r\n\r\nconstexpr Fraction multiply(const Fraction&amp; f1, const Fraction&amp; f2)\r\n{\r\n    return { f1.numerator * f2.numerator, f1.denominator * f2.denominator };\r\n}\r\n\r\nvoid printFraction(const Fraction&amp; f)\r\n{\r\n    std::cout &lt;&lt; f.numerator &lt;&lt; '\/' &lt;&lt; f.denominator &lt;&lt; '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n    Fraction f1{ getFraction() };\r\n    Fraction f2{ getFraction() };\r\n\r\n    std::cout &lt;&lt; \"Your fractions multiplied together: \";\r\n\r\n    printFraction(multiply(f1, f2));\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<\/div>\n<p class=\"cpp-quiz-question cpp-topline\" style=\"clear: both\">Question #3<\/p>\n<p>In the solution to the prior quiz question, why does <code>getFraction()<\/code> return by value instead of by reference?<\/p>\n<p><a class=\"solution_link_show\" href=\"javascript:void(0)\" onclick=\"cppSolutionToggle(document.getElementById('cpp_solution_id_2'), this, 'Show Solution', 'Hide Solution')\">Show Solution<\/a><\/p>\n<div class=\"wpsolution\" id=\"cpp_solution_id_2\" style=\"display:none\">\n<p>Because our <code>temp<\/code> Fraction is a local variable, it will go out of scope at the end of the function.  If we were to return <code>temp<\/code> as reference, we&#8217;d return a dangling reference back to the caller.\n<\/div>\n<div class=\"prevnext\"><div class=\"prevnext-inline\">\n\t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/struct-miscellany\/\">\n <div class=\"nav-button nav-button-next\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-right\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Next lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">13.11<\/span>Struct miscellany\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  \t<a class=\"nav-link\" href=\"\/\">\n  <div class=\"nav-button nav-button-index\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-home\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Back to table of contents<\/div>\n    <\/div>\n<\/div><\/a>\n  \t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/default-member-initialization\/\">\n  <div class=\"nav-button nav-button-prev\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-left\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Previous lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">13.9<\/span>Default member initialization\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  <\/div><\/div>\n","protected":false},"excerpt":{"rendered":"<p>Consider an employee represented by 3 loose variables: int main() { int id { 1 }; int age { 24 }; double wage { 52400.0 }; return 0; } If we want to pass this employee to a function, we have to pass three variables: #include &lt;iostream&gt; void printEmployee(int id, &hellip;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[3],"tags":[],"_links":{"self":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/12415"}],"collection":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/comments?post=12415"}],"version-history":[{"count":31,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/12415\/revisions"}],"predecessor-version":[{"id":17918,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/12415\/revisions\/17918"}],"wp:attachment":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/media?parent=12415"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/categories?post=12415"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/tags?post=12415"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}