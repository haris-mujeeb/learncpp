{"id":348,"date":"2009-09-20T10:10:33","date_gmt":"2009-09-20T18:10:33","guid":{"rendered":"http:\/\/www.learncpp.com\/?p=348"},"modified":"2023-06-15T16:09:02","modified_gmt":"2023-06-15T23:09:02","slug":"stdstring-construction-and-destruction","status":"publish","type":"post","link":"https:\/\/www.learncpp.com\/cpp-tutorial\/stdstring-construction-and-destruction\/","title":{"rendered":"22.2 &#8212; std::string construction and destruction"},"content":{"rendered":"<p>In this lesson, we&#8217;ll take a look at how to construct objects of std::string, as well as how to create strings from numbers and vice-versa.<\/p>\n<p><strong>String construction<\/strong><\/p>\n<p>The string classes have a number of constructors that can be used to create strings.  We&#8217;ll take a look at each of them here.<\/p>\n<p>Note: string::size_type resolves to size_t, which is the same unsigned integral type that is returned by the sizeof operator.  The actual size of size_t depending on the environment.  For the purposes of this tutorial, envision it as an unsigned int.<\/p>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string()<\/b><\/p>\n<ul>\n<li>This is the default constructor.  It creates an empty string.\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">std::string sSource;\r\nstd::cout &lt;&lt; sSource;<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string(const string&#038; strString)<\/b><\/p>\n<ul>\n<li>This is the copy constructor.  This constructor creates a new string as a copy of strString.\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">std::string sSource{ \"my string\" };\r\nstd::string sOutput{ sSource };\r\nstd::cout &lt;&lt; sOutput;<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\nmy string\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string(const string&#038; strString, size_type unIndex)<\/b><br \/>\n<b>string::string(const string&#038; strString, size_type unIndex, size_type unLength)<\/b><\/p>\n<ul>\n<li>This constructor creates a new string that contains at most unLength characters from strString, starting with index unIndex.  If a NULL is encountered, the string copy will end, even if unLength has not been reached.\n<li> If no unLength is supplied, all characters starting from unIndex will be used.\n<li>If unIndex is larger than the size of the string, the out_of_range exception will be thrown.\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">std::string sSource{ \"my string\" };\r\nstd::string sOutput{ sSource, 3 };\r\nstd::cout &lt;&lt; sOutput&lt;&lt; '\\n';\r\nstd::string sOutput2(sSource, 3, 4);\r\nstd::cout &lt;&lt; sOutput2 &lt;&lt; '\\n';<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\nstring\r\nstri\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string(const char* szCString)<\/b><\/p>\n<ul>\n<li>This constructor creates a new string from the C-style string szCString, up to but not including the NULL terminator.\n<li>If the resulting size exceeds the maximum string length, the length_error exception will be thrown.\n<li><b>Warning:<\/b> szCString must not be NULL.\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">const char* szSource{ \"my string\" };\r\nstd::string sOutput{ szSource };\r\nstd::cout &lt;&lt; sOutput &lt;&lt; '\\n';<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\nmy string\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string(const char* szCString, size_type unLength)<\/b><\/p>\n<ul>\n<li>This constructor creates a new string from the first unLength chars from the C-style string szCString.\n<li>If the resulting size exceeds the maximum string length, the length_error exception will be thrown.\n<li><b>Warning:<\/b> For this function only, NULLs are not treated as end-of-string characters in szCString!  This means it is possible to read off the end of your string if unLength is too big.  Be careful not to overflow your string buffer!\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">const char* szSource{ \"my string\" };\r\nstd::string sOutput(szSource, 4);\r\nstd::cout &lt;&lt; sOutput &lt;&lt; '\\n';<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\nmy s\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::string(size_type nNum, char chChar)<\/b><\/p>\n<ul>\n<li>This constructor creates a new string initialized by nNum occurances of the character chChar.\n<li>If the resulting size exceeds the maximum string length, the length_error exception will be thrown.\n<\/ul>\n<p>Sample code:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">std::string sOutput(4, 'Q');\r\nstd::cout &lt;&lt; sOutput &lt;&lt; '\\n';<\/code><\/pre>\n<p>Output:<\/p>\n<pre>\r\nQQQQ\r\n<\/pre>\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>template<class InputIterator> string::string(InputIterator itBeg, InputIterator itEnd)<\/b><\/p>\n<ul>\n<li>This constructor creates a new string initialized by the characters of range [itBeg, itEnd).\n<li>If the resulting size exceeds the maximum string length, the length_error exception will be thrown.\n<\/ul>\n<p>No sample code for this one.  It&#8217;s obscure enough you&#8217;ll probably never use it.\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<div class=\"cpp-table-wrapper\"><table class=\"cpp-table\"><\/p>\n<tr>\n<td>\n<b>string::~string()<\/b><\/p>\n<p><strong>String destruction<\/strong><\/p>\n<ul>\n<li>This is the destructor.  It destroys the string and frees the memory.\n<\/ul>\n<p>No sample code here either since the destructor isn&#8217;t called explicitly.\n<\/td>\n<\/tr>\n<p><\/table><\/div>\n<p><strong>Constructing strings from numbers<\/strong><\/p>\n<p>One notable omission in the std::string class is the lack of ability to create strings from numbers.  For example:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">    std::string sFour{ 4 };<\/code><\/pre>\n<p>Produces the following error:<\/p>\n<pre>\r\nc:vcprojectstest2test2test.cpp(10) : error C2664: 'std::basic_string&lt;_Elem,_Traits,_Ax&gt;::basic_string(std::basic_string&lt;_Elem,_Traits,_Ax&gt;::_Has_debug_it)' : cannot convert parameter 1 from 'int' to 'std::basic_string&lt;_Elem,_Traits,_Ax&gt;::_Has_debug_it'\r\n<\/pre>\n<p>Remember what I said about the string classes producing horrible looking errors?  The relevant bit of information here is:<\/p>\n<pre>cannot convert parameter 1 from 'int' to 'std::basic_string<\/pre>\n<p>In other words, it tried to convert your int into a string but failed.<\/p>\n<p>The easiest way to convert numbers into strings is to involve the std::ostringstream class.  std::ostringstream is already set up to accept input from a variety of sources, including characters, numbers, strings, etc&#8230;  It is also capable of outputting strings (either via the extraction operator>>, or via the str() function).  For more information on std::ostringstream, see <a href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/stream-classes-for-strings\/\">28.4 -- Stream classes for strings<\/a>.  <\/p>\n<p>Here&#8217;s a simple solution for creating std::string from various types of inputs:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n#include &lt;sstream&gt;\r\n#include &lt;string&gt;\r\n \r\ntemplate &lt;typename T&gt;\r\ninline std::string ToString(T tX)\r\n{\r\n    std::ostringstream oStream;\r\n    oStream &lt;&lt; tX;\r\n    return oStream.str();\r\n}<\/code><\/pre>\n<p>Here&#8217;s some sample code to test it:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">int main()\r\n{\r\n    std::string sFour{ ToString(4) };\r\n    std::string sSixPointSeven{ ToString(6.7) };\r\n    std::string sA{ ToString('A') };\r\n    std::cout &lt;&lt; sFour &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; sSixPointSeven &lt;&lt; '\\n';\r\n    std::cout &lt;&lt; sA &lt;&lt; '\\n';\r\n}<\/code><\/pre>\n<p>And the output:<\/p>\n<pre>\r\n4\r\n6.7\r\nA\r\n<\/pre>\n<p>Note that this solution omits any error checking.  It is possible that inserting tX into oStream could fail.  An appropriate response would be to throw an exception if the conversion fails.<\/p>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Related content<\/p>\n<p>The standard library also contains a function named <code>std::to_string()<\/code> that can be used to convert numbers into a std::string.  While this is a simpler solution for basic cases, the output of std::to_string may differ from the output of std::cout or our ToString() function above.  Some of these differences are currently documented <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/string\/basic_string\/to_string\">here<\/a>.\n<\/div>\n<p><strong>Converting strings to numbers<\/strong><\/p>\n<p>Similar to the solution above:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n#include &lt;sstream&gt;\r\n#include &lt;string&gt;\r\n \r\ntemplate &lt;typename T&gt;\r\ninline bool FromString(const std::string&amp; sString, T&amp; tX)\r\n{\r\n    std::istringstream iStream(sString);\r\n    return !(iStream &gt;&gt; tX).fail(); \/\/ extract value into tX, return success or not\r\n}<\/code><\/pre>\n<p>Here&#8217;s some sample code to test it:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">int main()\r\n{\r\n    double dX;\r\n    if (FromString(\"3.4\", dX))\r\n        std::cout &lt;&lt; dX &lt;&lt; '\\n'; \r\n    if (FromString(\"ABC\", dX))\r\n        std::cout &lt;&lt; dX &lt;&lt; '\\n'; \r\n}<\/code><\/pre>\n<p>And the output:<\/p>\n<pre>\r\n3.4\r\n<\/pre>\n<p>Note that the second conversion failed and returned false.<\/p>\n<div class=\"prevnext\"><div class=\"prevnext-inline\">\n\t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/stdstring-length-and-capacity\/\">\n <div class=\"nav-button nav-button-next\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-right\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Next lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">22.3<\/span>std::string length and capacity\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  \t<a class=\"nav-link\" href=\"\/\">\n  <div class=\"nav-button nav-button-index\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-home\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Back to table of contents<\/div>\n    <\/div>\n<\/div><\/a>\n  \t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/stdstring-and-stdwstring\/\">\n  <div class=\"nav-button nav-button-prev\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-left\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Previous lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">22.1<\/span>std::string and std::wstring\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  <\/div><\/div>\n","protected":false},"excerpt":{"rendered":"<p>In this lesson, we&#8217;ll take a look at how to construct objects of std::string, as well as how to create strings from numbers and vice-versa. String construction The string classes have a number of constructors that can be used to create strings. We&#8217;ll take a look at each of them &hellip;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[3],"tags":[],"_links":{"self":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/348"}],"collection":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/comments?post=348"}],"version-history":[{"count":22,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/348\/revisions"}],"predecessor-version":[{"id":14581,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/348\/revisions\/14581"}],"wp:attachment":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/media?parent=348"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/categories?post=348"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/tags?post=348"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}