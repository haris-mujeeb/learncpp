{"id":75,"date":"2007-06-21T18:55:27","date_gmt":"2007-06-22T02:55:27","guid":{"rendered":"http:\/\/www.learncpp.com\/cpp-tutorial\/54-goto-statements\/"},"modified":"2024-10-14T20:31:11","modified_gmt":"2024-10-15T03:31:11","slug":"goto-statements","status":"publish","type":"post","link":"https:\/\/www.learncpp.com\/cpp-tutorial\/goto-statements\/","title":{"rendered":"8.7 &#8212; Goto statements"},"content":{"rendered":"<p>The next kind of control flow statement we&#8217;ll cover is the unconditional jump.  An unconditional jump causes execution to jump to another spot in the code.  The term &#8220;unconditional&#8221; means the jump always happens (unlike an if-statement or switch-statement, where the jump only happens conditionally based on the result of an expression).<\/p>\n<p>In C++, unconditional jumps are implemented via a <strong>goto statement<\/strong>, and the spot to jump to is identified through use of a <strong>statement label<\/strong>.  Just like with switch case labels, statement labels are conventionally not indented.<\/p>\n<p>The following is an example of a goto statement and statement label:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n#include &lt;cmath&gt; \/\/ for sqrt() function\r\n\r\nint main()\r\n{\r\n    double x{};\r\ntryAgain: \/\/ this is a statement label\r\n    std::cout &lt;&lt; \"Enter a non-negative number: \"; \r\n    std::cin &gt;&gt; x;\r\n\r\n    if (x &lt; 0.0)\r\n        goto tryAgain; \/\/ this is the goto statement\r\n\r\n    std::cout &lt;&lt; \"The square root of \" &lt;&lt; x &lt;&lt; \" is \" &lt;&lt; std::sqrt(x) &lt;&lt; '\\n';\r\n    return 0;\r\n}<\/code><\/pre>\n<p>In this program, the user is asked to enter a non-negative number.  However, if a negative number is entered, the program utilizes a goto statement to jump back to the <code>tryAgain<\/code> label.  The user is then asked again to enter a new number.  In this way, we can continually ask the user for input until he or she enters something valid.<\/p>\n<p>Here&#8217;s a sample run of this program:<\/p>\n<pre>\nEnter a non-negative number: -4\r\nEnter a non-negative number: 4\r\nThe square root of 4 is 2\r\n<\/pre>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Statement labels have function scope<\/p>\n<p>In the chapter on object scope (<a href=\"https:\/\/www.learncpp.com#Chapter7\">chapter 7<\/a>), we covered two kinds of scope: local (block) scope, and file (global) scope.  Statement labels utilize a third kind of scope: <strong>function scope<\/strong>, which means the label is visible throughout the function even before its point of declaration.  The goto statement and its corresponding <code>statement label<\/code> must appear in the same function.<\/p>\n<p>While the above example shows a goto statement that jumps backwards (to a preceding point in the function), goto statements can also jump forward:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nvoid printCats(bool skip)\r\n{\r\n    if (skip)\r\n        goto end; \/\/ jump forward; statement label 'end' is visible here due to it having function scope\r\n    \r\n    std::cout &lt;&lt; \"cats\\n\";\r\nend:\r\n    ; \/\/ statement labels must be associated with a statement\r\n}\r\n\r\nint main()\r\n{\r\n    printCats(true);  \/\/ jumps over the print statement and doesn't print anything\r\n    printCats(false); \/\/ prints \"cats\"\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<p>This prints:<\/p>\n<pre>\ncats\r\n<\/pre>\n<p>Beyond the jumping forward, there are a couple of interesting things worth mentioning in the program above.<\/p>\n<p>First, note that statement labels must be associated with a statement (hence their name: they label a statement).  Because the end of the function had no statement, we had to use a null statement so we had a statement to label.  Second, we were able to jump to the statement labeled by <code>end<\/code> even though we hadn&#8217;t declared <code>end<\/code> yet due to statement labels having function scope.  No forward declaration of statement labels is necessary.  Third, it&#8217;s worth explicitly mentioning that the above program is poor form -- it would have been better to use an if-statement to skip the print statement than a goto statement to jump over it.<\/p>\n<p>There are two primary limitations to jumping: You can jump only within the bounds of a single function (you can&#8217;t jump out of one function and into another), and if you jump forward, you can&#8217;t jump forward over the initialization of any variable that is still in scope at the location being jumped to.  For example:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">int main()\r\n{\r\n    goto skip;   \/\/ error: this jump is illegal because...\r\n    int x { 5 }; \/\/ this initialized variable is still in scope at statement label 'skip'\r\nskip:\r\n    x += 3;      \/\/ what would this even evaluate to if x wasn't initialized?\r\n    return 0;\r\n}<\/code><\/pre>\n<p>Note that you can jump backwards over a variable initialization, and the variable will be re-initialized when the initialization is executed.<\/p>\n<p class=\"cpp-section cpp-topline\" style=\"clear: both\">Avoid using goto<\/p>\n<p>Use of <code>goto<\/code> is shunned in C++ (and other modern high level languages as well).  <a href=\"http:\/\/en.wikipedia.org\/wiki\/Edsger_Dijkstra\">Edsger W. Dijkstra<\/a>, a noted computer scientist, laid out the case for avoiding goto in a famous but difficult to read paper called <a href=\"http:\/\/www.cs.utexas.edu\/users\/EWD\/ewd02xx\/EWD215.PDF\">Go To Statement Considered Harmful<\/a>.  The primary problem with goto is that it allows a programmer to jump around the code arbitrarily.  This creates what is not-so-affectionately known as spaghetti code.  <strong>Spaghetti code<\/strong> is code that has a path of execution that resembles a bowl of spaghetti (all tangled and twisted), making it extremely difficult to follow the logic of such code.<\/p>\n<p>As Dijkstra says somewhat humorously, &#8220;the quality of programmers is a decreasing function of the density of go to statements in the programs they produce&#8221;.<\/p>\n<p>Almost any code written using a goto statement can be more clearly written using other constructs in C++, such as if-statements and loops.  One notable exception is when you need to exit a nested loop but not the entire function -- in such a case, a goto to just beyond the loops is probably the cleanest solution.<\/p>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">For advanced readers<\/p>\n<p>Here&#8217;s a contrived example of using a goto to exit a nested loop without exiting the function:<\/p>\n<pre class=\"language-cpp line-numbers\"><code class=\"language-cpp match-braces\">#include &lt;iostream&gt;\r\n\r\nint main()\r\n{\r\n    for (int i = 1; i &lt; 5; ++i)\r\n    {        \r\n        for (int j = 1; j &lt; 5; ++j)\r\n        {\r\n            std::cout &lt;&lt; i &lt;&lt; \" * \" &lt;&lt; j &lt;&lt; \" is \" &lt;&lt; i*j &lt;&lt; '\\n';\r\n            \r\n            \/\/ If the product is divisible by 9, jump to the \"end\" label\r\n            if (i*j % 9 == 0)\r\n            {\r\n                std::cout &lt;&lt; \"Found product divisible by 9.  Ending early.\\n\";\r\n                goto end;\r\n            }\r\n        }\r\n\r\n        std::cout &lt;&lt; \"Incrementing the first factor.\\n\";\r\n    }\r\n\r\nend:\r\n    std::cout &lt;&lt; \"And we're done.\" &lt;&lt; '\\n';\r\n\r\n    return 0;\r\n}<\/code><\/pre>\n<\/div>\n<div class=\"cpp-note cpp-lightgraybackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Author&#8217;s note<\/p>\n<p>From our friends at <a href=\"https:\/\/xkcd.com\/292\/\">xkcd<\/a>:<\/p>\n<p><img src=\"https:\/\/imgs.xkcd.com\/comics\/goto.png\" alt=\"https:\/\/imgs.xkcd.com\/comics\/goto.png\">\n<\/div>\n<div class=\"cpp-note cpp-lightgreenbackground\">\n<p class=\"cpp-note-title cpp-bottomline\">Best practice<\/p>\n<p>Avoid goto statements (unless the alternatives are significantly worse for code readability).\n<\/p><\/div>\n<div class=\"prevnext\"><div class=\"prevnext-inline\">\n\t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/introduction-to-loops-and-while-statements\/\">\n <div class=\"nav-button nav-button-next\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-right\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Next lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">8.8<\/span>Introduction to loops and while statements\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  \t<a class=\"nav-link\" href=\"\/\">\n  <div class=\"nav-button nav-button-index\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-home\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Back to table of contents<\/div>\n    <\/div>\n<\/div><\/a>\n  \t<a class=\"nav-link\" href=\"https:\/\/www.learncpp.com\/cpp-tutorial\/switch-fallthrough-and-scoping\/\">\n  <div class=\"nav-button nav-button-prev\">\n    <div class=\"nav-button-icon\"><i class=\"fa fa-chevron-circle-left\" aria-hidden=\"true\"><\/i><\/div>\n    <div class=\"nav-button-text\">\n      <div class=\"nav-button-title\">Previous lesson<\/div>\n      <div class=\"nav-button-lesson\">\n        <span class=\"nav-button-lesson-number\">8.6<\/span>Switch fallthrough and scoping\n      <\/div>\n    <\/div>\n  <\/div><\/a>\n  <\/div><\/div>\n","protected":false},"excerpt":{"rendered":"<p>The next kind of control flow statement we&#8217;ll cover is the unconditional jump. An unconditional jump causes execution to jump to another spot in the code. The term &#8220;unconditional&#8221; means the jump always happens (unlike an if-statement or switch-statement, where the jump only happens conditionally based on the result of &hellip;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[3],"tags":[],"_links":{"self":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/75"}],"collection":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/comments?post=75"}],"version-history":[{"count":21,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/75\/revisions"}],"predecessor-version":[{"id":17750,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/posts\/75\/revisions\/17750"}],"wp:attachment":[{"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/media?parent=75"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/categories?post=75"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.learncpp.com\/wp-json\/wp\/v2\/tags?post=75"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}